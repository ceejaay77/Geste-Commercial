<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Générateur d'Avoir / Geste Commercial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Professional -->
    <!-- Application Structure Plan: A two-panel SPA. The left panel contains a streamlined form for general invoice details (number, date, place), client information, and the commercial gesture amount. The right panel provides a real-time, clean preview of the "Avoir / Geste Commercial" document, structured like a standard invoice. This design prioritizes efficiency and clarity for generating formal financial documents. A print function allows for easy PDF generation. -->
    <!-- Visualization & Content Choices: Report Info (invoice template) -> Goal (generate a formal commercial gesture invoice) -> Presentation (HTML form + live invoice preview div) -> Interaction (oninput/onchange events update financial calculations and textual fields in real-time) -> Justification (Provides a quick, accurate, and visually standard way to create commercial gesture invoices, focusing on financial clarity) -> Library/Method (Vanilla JS, Tailwind CSS). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            #form-section, #header-section, #actions-section {
                display: none !important;
            }
            #preview-section {
                width: 100% !important;
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                border: none !important;
                box-shadow: none !important;
                background-color: white !important;
            }
            #preview-document {
                 box-shadow: none !important;
                 border: none !important;
                 height: auto;
            }
            main {
                padding: 0 !important;
                background-color: white !important;
            }
        }
    </style>
</head>
<body class="bg-stone-100 text-stone-800">

    <main class="min-h-screen p-4 sm:p-6 lg:p-8">
        <div class="max-w-7xl mx-auto">
            
            <header id="header-section" class="text-center mb-8">
                <h1 class="text-3xl font-bold text-stone-900">Générateur d'Avoir / Geste Commercial</h1>
                <p class="mt-2 text-stone-600">Remplissez les champs pour générer votre document d'avoir.</p>
            </header>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- Form Section -->
                <section id="form-section" class="bg-white p-6 rounded-2xl shadow-lg">
                    <form id="invoice-form" class="space-y-6">
                        
                        <div>
                            <h2 class="text-xl font-semibold border-b pb-2 mb-4 text-stone-700">Informations de l'Avoir</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="invoice-number" class="block text-sm font-medium text-stone-600">Numéro de l'Avoir</label>
                                    <input type="text" id="invoice-number" value="AVOIR-2025-001" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                                </div>
                                <div>
                                    <label for="issue-date" class="block text-sm font-medium text-stone-600">Date d'émission</label>
                                    <input type="date" id="issue-date" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                                </div>
                                 <div>
                                    <label for="issue-place" class="block text-sm font-medium text-stone-600">Lieu d'émission</label>
                                    <input type="text" id="issue-place" placeholder="Ville" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                                </div>
                            </div>
                        </div>

                        <div>
                            <h2 class="text-xl font-semibold border-b pb-2 mb-4 text-stone-700">Vos Informations Client</h2>
                            <div class="space-y-4">
                                <div>
                                    <label for="client-name" class="block text-sm font-medium text-stone-600">Votre nom de société</label>
                                    <input type="text" id="client-name" placeholder="Votre nom d'entreprise" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                                </div>
                                <div>
                                    <label for="client-address" class="block text-sm font-medium text-stone-600">Votre adresse complète</label>
                                    <textarea id="client-address" rows="3" placeholder="123 Rue de l'Exemple&#10;75001 Paris" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2"></textarea>
                                </div>
                                <div>
                                    <label for="client-legal" class="block text-sm font-medium text-stone-600">Vos infos légales (SIRET, TVA...)</label>
                                    <input type="text" id="client-legal" placeholder="SIRET : 123 456 789 00012" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                                </div>
                            </div>
                        </div>

                        <div>
                            <h2 class="text-xl font-semibold border-b pb-2 mb-4 text-stone-700">Montant du Geste Commercial</h2>
                            <div>
                                <label for="amount-ht" class="block text-sm font-medium text-stone-600">Montant Hors Taxes</label>
                                <div class="relative mt-1 rounded-md shadow-sm">
                                    <input type="number" id="amount-ht" value="100.00" step="0.01" class="block w-full rounded-md border-stone-300 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                                        <span class="text-gray-500 sm:text-sm">€</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </section>

                <!-- Preview Section -->
                <section id="preview-section" class="h-full">
                     <div id="preview-document" class="bg-white p-8 sm:p-10 lg:p-12 rounded-2xl shadow-lg h-full border border-stone-200 sticky top-8">
                        <div class="space-y-6">
                            <h2 class="text-2xl font-bold text-stone-900 text-center">AVOIR / GESTE COMMERCIAL</h2>
                            <p class="text-stone-700 font-medium text-center">Numéro : <span id="preview-invoice-number"></span></p>

                            <hr class="my-6">
                            
                            <div class="grid grid-cols-2 gap-8">
                                <div>
                                    <h3 class="font-semibold text-stone-800">VISTALID</h3>
                                    <p class="text-sm text-stone-600 mt-1">
                                        210 COURS VICTOR HUGO<br>
                                        33130 BEGLES
                                    </p>
                                </div>
                                <div class="text-right">
                                     <p class="text-sm text-stone-600"><span class="font-semibold">Date d'émission :</span> <span id="preview-issue-date"></span></p>
                                     <p class="text-sm text-stone-600"><span class="font-semibold">Lieu d'émission :</span> <span id="preview-issue-place"></span></p>
                                </div>
                            </div>

                            <hr class="my-6">

                            <div>
                                <h3 class="font-semibold text-stone-800">CLIENT :</h3>
                                <div class="mt-1 text-sm text-stone-600">
                                    <p id="preview-client-name" class="font-bold"></p>
                                    <p id="preview-client-address" class="whitespace-pre-line"></p>
                                    <p id="preview-client-legal" class="mt-1"></p>
                                </div>
                            </div>

                            <div class="overflow-x-auto mt-8">
                                <table class="min-w-full text-sm">
                                    <thead class="bg-stone-100">
                                        <tr>
                                            <th class="py-2 px-4 font-semibold text-left text-stone-700">Désignation</th>
                                            <th class="py-2 px-4 font-semibold text-right text-stone-700">Prix HT (€)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b">
                                            <td class="py-3 px-4">Geste Commercial</td>
                                            <td id="preview-amount-ht" class="py-3 px-4 text-right"></td>
                                        </tr>
                                    </tbody>
                                    <tfoot class="font-semibold">
                                        <tr>
                                            <td class="py-2 px-4 text-right">Sous-total Hors Taxes</td>
                                            <td id="preview-subtotal" class="py-2 px-4 text-right"></td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 px-4 text-right">TVA (20%)</td>
                                            <td id="preview-tva" class="py-2 px-4 text-right"></td>
                                        </tr>
                                        <tr class="bg-stone-100 text-base">
                                            <td class="py-3 px-4 text-right">TOTAL TTC</td>
                                            <td id="preview-total" class="py-3 px-4 text-right"></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                             
                            <div class="text-center pt-6 text-xs text-stone-500">
                                <p class="font-semibold">VISTALID</p>
                                <p>SIRET 123 456 789 00010 - RCS Bordeaux - Capital Social 1000€</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            
            <div id="actions-section" class="mt-8 flex justify-center items-center gap-4">
                <button type="button" id="print-button" class="px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition">
                    Imprimer le Document
                </button>
                 <button type="reset" form="invoice-form" class="px-6 py-3 bg-stone-200 text-stone-700 font-semibold rounded-lg hover:bg-stone-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-stone-500 transition">
                    Réinitialiser
                </button>
            </div>

        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('invoice-form');
            const TVA_RATE = 0.20;

            const fields = {
                invoiceNumber: document.getElementById('invoice-number'),
                issueDate: document.getElementById('issue-date'),
                issuePlace: document.getElementById('issue-place'),
                clientName: document.getElementById('client-name'),
                clientAddress: document.getElementById('client-address'),
                clientLegal: document.getElementById('client-legal'),
                amountHT: document.getElementById('amount-ht'),
            };

            const preview = {
                invoiceNumber: document.getElementById('preview-invoice-number'),
                issueDate: document.getElementById('preview-issue-date'),
                issuePlace: document.getElementById('preview-issue-place'),
                clientName: document.getElementById('preview-client-name'),
                clientAddress: document.getElementById('preview-client-address'),
                clientLegal: document.getElementById('preview-client-legal'),
                amountHT: document.getElementById('preview-amount-ht'),
                subtotal: document.getElementById('preview-subtotal'),
                tva: document.getElementById('preview-tva'),
                total: document.getElementById('preview-total'),
            };

            function formatCurrency(value) {
                const number = parseFloat(value);
                return isNaN(number) ? '0,00' : number.toFixed(2);
            }

            function formatDate(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                const options = { year: 'numeric', month: '2-digit', day: '2-digit' };
                return date.toLocaleDateString('fr-FR', options);
            }

            function updatePreview() {
                const ht = parseFloat(fields.amountHT.value) || 0;
                const tva = ht * TVA_RATE;
                const ttc = ht + tva;
                
                preview.invoiceNumber.textContent = fields.invoiceNumber.value || 'AVOIR-XXXX-XXX';
                preview.issueDate.textContent = formatDate(fields.issueDate.value);
                preview.issuePlace.textContent = fields.issuePlace.value || 'Ville';
                preview.clientName.textContent = fields.clientName.value || 'Votre nom de société';
                preview.clientAddress.textContent = fields.clientAddress.value || 'Votre adresse complète';
                preview.clientLegal.textContent = fields.clientLegal.value || 'Vos infos légales';
                
                preview.amountHT.textContent = formatCurrency(ht);
                preview.subtotal.textContent = formatCurrency(ht);
                preview.tva.textContent = formatCurrency(tva);
                preview.total.textContent = formatCurrency(ttc);
            }

            // Set today's date by default
            const today = new Date().toISOString().split('T')[0];
            fields.issueDate.value = today;
            
            // Initial update
            updatePreview();

            // Event Listeners
            form.addEventListener('input', updatePreview);
            form.addEventListener('change', updatePreview);

            form.addEventListener('reset', () => {
                setTimeout(() => {
                    fields.issueDate.value = today; // Reset date to today
                    fields.issuePlace.value = ''; // Clear lieu d'émission on reset
                    updatePreview();
                }, 0); // Update after reset
            });

            document.getElementById('print-button').addEventListener('click', () => {
                window.print();
            });
        });
    </script>
</body>
</html>
